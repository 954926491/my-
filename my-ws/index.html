<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <style type="text/css">
            #show{
                min-height: 200px;
                width: 50%;
                border: solid 1px;
                margin-bottom: 15px;
            }
            #message{
                width: 30%;
                padding: 5px 0;
            }
            #name{
                width: 18%;
                padding: 5px 0;
            }
            a{
                text-decoration: none;
                padding: 15px 20px;
                background: #1571FA;
                color: #fff;
                transition: 0.5s all;
               -webkit-transition: 0.5s all;
               -moz-transition: 0.5s all;
               -o-transition: 0.5s all;
               -ms-transition: 0.5s all;
            }
            a:hover{
                background:#5FC4FD; 
            }
        </style>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.js"></script>  
    </head>
    <body>
        <div id="show"></div>
        <input type="text" value="" id="message" placeholder="请输入消息">
        <input type="text" value="" id="name" placeholder="昵称">
        <br/><br><br>
        <a href="javascript:void(0)" onclick="send()">发送</a>
        <a href="javascript:void(0)" onclick="exit()">退出</a>
    </body>
    <script type="text/javascript">
        var ws=new WebSocket("ws://127.0.0.1:3000?t=text");
        ws.onopen=function(){
            console.log('状态：',ws);
            $('#show').html("连接状态："+ws.readyState+"<br>");
            console.log("open");
            ws.open("start");
        };
        ws.onmessage=function(evt){
            $('#show').append(evt.data+'<br>');
        };
        ws.onclose=function(){
            console.log('服务关闭');
        };
        ws.onerror=function(evt){
            console.log("错误: "+evt.error);
        };
        function send(){
            var name=$('#name').val();
            var message=$('#message').val();
            //var dataStr='{"name":'+name+',"msg":'+message+"}";
            var dataStr="{name:'" + name + "',msg:'" + message +  "'}";  
            console.log('发生数据');
            ws.send(dataStr);
        }
        function exit(){
            var r=ws.close();
            console.log("关闭",r);
        }
    </script>
</html>